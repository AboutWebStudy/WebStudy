## 프록시 서버

프록시 서버(Proxy Server)는 클라이언트와 인터넷(또는 다른 서버) 사이에 위치하여 중계자 역할을 하는 서버입니다. 프록시 서버는 여러 가지 중요한 역할을 수행하며, 다음과 같은 주요 기능을 제공한다.

- **중개 역할 (요청 중계)**
    - 클라이언트(사용자)가 직접 목적지 서버에 접속하지 않고, 프록시 서버를 통해 요청을 보냄
    - 프록시 서버는 해당 요청을 받아서 목적지 서버에 전달하고, 응답을 클라이언트에게 다시 전달
- **보안 및 익명성 제공**
    - 클라이언트의 IP 주소를 숨기고 프록시 서버의 IP로 대신 요청하므로 **익명성** 유지
    - 조직에서는 내부 IP 주소를 외부에 노출하지 않기 위해 프록시 서버를 사용
- **콘텐츠 필터링 및 접근 제어**
    - 관리자나 기업은 특정 웹사이트나 서비스에 대한 **접근을 차단하거나 제한**
    - 예: 학교에서 유해 사이트 차단
- **캐싱 기능**
    - 자주 요청되는 데이터를 프록시 서버가 저장(cache)하여, 다시 요청될 때 **더 빠르게 제공**
    - 이는 **대역폭 절약**과 **응답 속도 향상**
- **보안 검사 및 로깅**
    - 악성 코드나 비정상적인 요청을 탐지하고 차단
    - 사용자의 웹 사용 기록을 기록하여 **모니터링 또는 감사 용도**로 사용
- **우회 접속**
    - 지역 제한이 있는 콘텐츠나 차단된 사이트에 **우회 접속**.
    - VPN과 유사하지만, 더 단순한 방식

## 프록시 종류

- **포워드 프록시 주요 기능**
    - **내부 사용자의 외부 인터넷 접근 제어**
    - **IP 주소 숨김 및 익명성 제공**
    - **캐싱을 통해 속도 향상 및 대역폭 절약**
    - **보안 정책 적용**: 유해 사이트 차단, 악성 트래픽 차단 등
    - **사용자 활동 로깅** 및 감사 기능
- **리버스 프록시 주요 기능**
    - **로드 밸런싱**: 요청을 여러 서버에 분산시켜 성능 최적화
    - **내부 서버 보호**: 실제 서버의 IP를 숨기고 외부 접근 제한
    - **SSL 종료(암복호화)**: 암호화된 연결을 프록시에서 처리
    - **캐싱 제공**: 정적 콘텐츠를 미리 저장하여 응답 속도 향상
    - **방화벽 역할**: 악성 요청 필터링

## 프록시 서버 구축 시 주의점

- SPOF(Single Point Of Failure) 문제
    - **문제**: 하나의 프록시 서버가 중단되면 전체 네트워크나 서비스 접근이 마비될 수 있음.
    - **해결**:
        - **수평 확장(Horizontal Scaling)**: 여러 대의 프록시 서버를 구성하고 로드 밸런서로 트래픽 분산
        - **HA 구성 (High Availability)**: 장애 조치(Failover)를 위한 이중화 구성 (예: Keepalived, Heartbeat)
        - **클러스터링**: 여러 서버를 하나의 클러스터로 묶어 자동 장애 복구 지원
- **성능 병목**
    - 프록시 서버 자체가 **네트워크의 병목**이 되지 않도록 주의
    - **캐싱 정책**, **연결 수 제한**, **리소스 모니터링** 필요
    - **멀티스레드 또는 비동기 처리**가 가능한 소프트웨어 선택 (예: Nginx, HAProxy)

### 포워드 프록시 구축 방법

### Squid: 포워드 프록시의 대표

- HTTP, HTTPS 둘 다 완전 지원 (CONNECT 포함)
- 사용자 인증, ACL, IP 제한, 도메인 필터링 등 강력함
- 기본 역할: 기업/학교/보안망에서 외부 요청 제어

### **Nginx**: 제한적 포워드 프록시

- HTTP 요청에 대해 `proxy_pass` 지시어를 사용하여 포워딩 가능
- 기본적으로 `CONNECT` 메서드를 지원하지 않아 **HTTPS 중계가 불가능**
- 단, [ngx_http_proxy_connect_module](https://github.com/chobits/ngx_http_proxy_connect_module) 모듈(오픈소스)을 추가하면 제한적으로 가능

### **HAProxy**: 포워드 프록시로는 안 씀

- L4 / L7 리버스 프록시 전문
- 외부 인터넷 중계 방식의 **포워드 프록시 구조 자체를 지원하지 않음**
- 즉, **내부 사용자가 외부에 요청할 때 경유용**으로 쓰는 게 아님
