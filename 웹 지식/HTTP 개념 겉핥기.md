# HTTP 개관

웹브라우저, 서버, 웹 애플리케이션은 보통의 경우 HTTP(Hypertext Transfer Protocol)을 통해 서로 대화한다.

## HTTP: 인터넷의 멀티미디어 배달부

http는 신뢰성 있는 데이터 전송 프로토콜을 사용하기 때문에, 데이터가 지구 반대편에서 오더라도 전송 중 손상되거나 꼬이지 않음을 보장한다.

## 웹 클라이언트와 서버

웹 콘텐츠는 웹 서버에 존재한다. 웹 서버는 HTTP 프로토콜로 의사소통하기 때문에 보통 HTTP 서버라고 불린다. 이들 웹 서버는 인터넷의 데이터를 저장하고, HTTP 클라이언트가 요청한 데이터를 제공한다.

- 웹 브라우저에서의 HTTP 통신

클라이언트 → 서버 - HTTP요청 “/index.html의 문서 request”
서버 → 클라이언트 - HTTP응답 “HTTP포맷으로 되어있고,길이 3,150글자를 가진 파일 response”

## 리소스

웹 서버에서 웹 리소스를 관리하고 요청에 따라 response한다.

서버에서 response를 할 때는 그림이나 동영상 등의 정적 파일을 response할 수도 있고, 요청자의 상태에 따라 실시간으로 데이터베이스 검색값 등의 정보를 전달할 수도 있다.

### 미디어 타입

http통신시 각 리소스의 타입을 구분하기 위해 **MIME**(Multipurpose Internet Mail Extensions)으로 콘텐츠를 기술한다.

- 사선으로 구분한다.
- 주 타입(primary object type)
- 부 타입(specific subtype)
- ex) text/html, image/gif, application/json 등

### URI(Uniform Resource Identifier)

웹 서버에서 리소스는 각 엔드포인트에 따라 관리되는데, 인터넷의 정확한 정보가 담겨있는 정확한 주소이다. 이 uri의 세부 종류로는 URL, URN 두가지로 자원을 관리하는 식별자가 된다.

### URL(Uniform Resource Locator)

리소스 식별자의 가장 흔한 형태로 특정 서버의 한 리소스에 대한 구체적인 위치를 서술한다.

서버의 인터넷 주소를 통해 리소스의 정확한 위치와 접근방법을 표현

- http://www.naver.com/image.jpg
    - http : 스킴 - 리소스에 접근하기 위해 사용되는 통신 프로토콜
    - www.naver.com : 서버의 인터넷 주소
    - image.jpg : 웹 서버의 리소스

### URN(Uniform Resource Name)

콘텐츠를 이루는 한 리소스에 대해 리소스의 위치에 영향을 받지 않는 유일무이한 이름 역할

- urn:ietf:rfc:2141
- URN을 사용할 때는 리소스 위치를 분석하기 위해 인프라 지원이 필수

## HTTP 트랜잭션

웹 서버와 리소스를 주고받을 때의 흐름

클라이언트 request → 서버 response

- 클라이언트 HTTP 요청 예시
    - GET /specials/saw-blade.gif HTTP/1.0 Host: www.joes-hardware.com
- 서버 HTTP 응답 예시
    - HTTP/1.0 200 OK Content-type: image/gif Content-length: 8572

### 메서드

서버에 HTTP 요청시 **한개의 메서드**에 원하는 동작을 담아 요청

- 대표적인 HTTP 메서드
    - GET - 서버에서 클라이언트로 지정한 리소스를 보내라
    - PUT - 클라이언트에서 서버로 보낸 데이터를 지정한 이름의 리소스로 변경하라
    - PATCH - 클라이언트에서 서버로 보낸 데이터를 업데이트하라
    - POST - 클라이언트 데이터를 서버 게이트웨이 애플리케이션으로 보내라
    - DELETE - 지정한 리소스를 서버에서 삭제하라
    - HEAD - 지정한 리소스에 대한 응답에서 HTTP 헤더만 보내라

### 상태 코드

모든 HTTP 응답시에는 상태 코드와 함께 반환된다. 상태 코드는 클라이언트에게 요청이 성공했는지 아니면 추가 조치가 필요한지 알려주는 세 자리 숫자이다.

- 대표적인 상태코드
    - 200 OK
    - 302 다시 보내고, 다른 곳에서 리소스를 가져가라
    - 404 리소스를 찾을 수 없다.

각 상태 코드는 텍스트로 된 사유 구절이 존재한다(reson phrase)

### 웹 페이지는 여러 객체로 이루어질 수 있다

애플리케이션은 보통 하나의 작업을 수행하기 위해 여러 HTTP 트랜잭션을 수행한다.
이 때 동작형식은 html뼈대를 1차로 가져온 후 html 뼈대 안에 들어있는 이미지, 외부 데이터 요청 등을 추가 HTTP 트랜잭션을 통해 수행된다.

따라서 대부분의 **웹페이지**는 하나의 리소스가 아닌 `리소스의 모음`이다

## 메시지

HTTP 요청과 응답 메시지는 단순한 줄 단위의 문자열이다. 때문에 개발자들이 개발시에 확장과 디버그에 용이하다.

- 시작줄
메시지의 첫 줄은 시작줄로, 요청이라면 무엇을 해야하는지 응답이라면 무슨 일이 일어났는지 나타낸다.
- 헤더
시작줄 다음에는 0개 이상의 헤더 필드가 이어진다. 각 헤더 필드는 쉬운 구문분석을 위해 쌍점(:)으로 구분되어 있는 하나의 이름과 하나의 값으로 구성된다. 헤더의 끝은 빈줄이다.
- 본문
빈 줄 다음에 어떤 데이터든 들어갈 수 있는 메시지 본문이 필요에 따라 갈 수 있다.(이진데이터 포함)

### 간단한 메시지의 예

![image](https://github.com/AboutWebStudy/WebStudy/assets/75903442/5cab32eb-8ad4-49f3-8ef1-3c0d0916ec9f)


## TCP(Transmission Control Protocol) 커넥션

### TCP/IP

HTTP는 애플리케이션 계층 프로토콜이다. HTTP는 네트워크 통신의 핵심적인 세부사항에 대해서 신경 쓰지 않고 신뢰성 있는 TCP/IP에 맡긴다.

- 오류 없는 데이터 전송
- 순서에 맞는 전달 (데이터는 언제나 보낸 순서대로 도착한다)
- 조각나지 않는 데이터 스트림 (언제든 어떤 크기로든 보낼 수 있다)

네트워크의 개념상 HTTP는 TCP의 상위계층이다. 따라서 HTTP는 자신의 메시지를 전송하기 위해 TCP를 사용한다. 이와 유사하게 TCP는 IP를 사용한다.

### 접속, IP주소 그리고 포트번호

HTTP 클라이언트가 서버에 메시지를 전송할 수 있게 되기 전에, 인터넷 프로토콜 주소와 포트번호를 사용해 클라이언트와 서버 사이에 TCP/IP 커넥션을 맺어야 한다. 커넥션이 맺어질 때TCP에서 요구하는 것이 서버 컴퓨터에 대한 IP 주소와 프로그램이 사용하고있는 포트번호이다.

추가로 http통신의 기본 포트번호는 80이다.

통신의 흐름

- 서버의 URL에서 호스트 명을 추출
- 서버의 호스트명을 IP로 변환
- URL에 포트번호가 있다면 포트번호 추출
- 웹 서버와 TCP 커넥션
- 서버에 HTTP 요청
- 웹 브라우저에 HTTP 응답
- 커넥션 닫힌 후 웹 브라우저 출력

## 프로토콜 버전

Http 0.9 → 1.0 → 1.0+ → 1.1 → 2.0 버전순

- HTTP/0.9
HTTP 프로토타입으로 오직 GET 메서드만 지원
- HTTP/1.0
널리 쓰이기 시작한 첫번째 HTTP 버전으로 버전 번호, HTTP헤더, 추가 메서드, 멀티미디어 객체 처리를 추가했다. HTTP/1.0은 잘 정의된 명세는 아니지만, 잘 동작하는 용례들의 모음이다.
- HTTP/1.0+
오래 지속되는 keep-alive 커넥션 가상 호스팅 지원, 프록시 연결 지원을 포함해 많은 기능이 추가되며 표준에 가까워졌다.
- HTTP/1.1
HTTP설계의 구조적 결함 교정, 성능 최적화, 잘못된 기능 제거에 집중된 버전
- HTTP/2.0
1.1의 성능 문제를 개선하기 위해 구글의 SPDY 프로토콜을 기반으로 설계가 진행중

## 웹의 구성요소

웹 애플리케이션이 기본적인 트랜잭션을 구현할 때 어떻게 메시지를 주고받는지 간략한 설명

- 프록시
클라이언트와 서버 사이에 위치한 HTTP 중재자
- 캐시
많이 찾는 웹 페이지를 클라이언트 가까이에 보관하는 HTTP 창고
- 게이트웨이
다른 애플리케이션과 연결된 특별한 웹 서버
- 터널
단순히 HTTP 통신을 전달하기만 하는 특별한 프락시
- 에이전트
자동화된 HTTP 요청을 만드는 준지능적 웹클라이언트

### 프록시

웹 보안, 애플리케이션 통합, 성능 최적화를 위한 중요한 구성요소, 클라이언트와 서버 사이에 위치하여 클라이언트의 모든 HTTP 요청을 받아 필터를 거친 후 서버에 전달한다.

### 캐시

성능의 향상을 위해 클라이언트가 같은 문서를 요청했을 때 그 캐시가 갖고 있는 사본을 저장해 받을 수 있게하여, 통신 시간을 줄일 수 있는 기능

### 게이트웨이

다른 서버들의 중개자로 동작하는 서버. 게이트웨이는 주로 HTTP 트래픽을 다른 프로토콜로 변환하기 위해 사용된다.
언제나 스스로가 리소스를 갖고 있는 진짜 서버인 것처럼 요청을 다룬다.

### 터널

터널은 두 커넥션 사이에서 raw 데이터를 열어보지 않고 그대로 전달해주는 HTTP 애플리케이션이다.

터널은 주로 비 HTTP 데이터를 하나 이상의 HTTP 연결을 통해 그대로 전송해주기 위해 사용된다.

HTTP 터널을 활용하는 대표적인 예로, 암호화된 SSL 트래픽을 HTTP 커넥션으로 전송함으로써 웹 트래픽만 허용하는 사내 방화벽을 통과시키는 것이 있다.

### 에이전트

사용자 에이전트는 사용자를 위해 HTTP 요청을 만들어주는 클라이언트 프로그램이다.
웹 요청을 만드는 애플리케이션은 뭐든 HTTP 에이전트이다.

출처: [HTTP완벽 가이드](https://product.kyobobook.co.kr/detail/S000001033001)
