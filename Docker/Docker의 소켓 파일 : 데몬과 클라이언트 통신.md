### π‘‰ μ†μΌ“(Socket) νμΌμ κ°λ…

---

- μ†μΌ“ νμΌμ€ μ»΄ν“¨ν„° λ‚΄μ—μ„ ν”„λ΅μ„Έμ¤ κ°„ ν†µμ‹ μ„ μ„ν• μΈν„°νμ΄μ¤λ¥Ό μ κ³µν•λ” νμΌ ν•νƒμ ν†µμ‹  μ±„λ„
- μ£Όλ΅ λ¦¬λ…μ¤ ν™κ²½μ—μ„ `*.sock` ν™•μ¥μλ΅ λ‚νƒ€λ‚λ©°, λ΅μ»¬μ—μ„ ν”„λ΅μ„Έμ¤ κ°„ λ„¤νΈμ›ν¬ ν†µμ‹  μ—†μ΄λ„ λ°μ΄ν„°λ¥Ό μ£Όκ³ λ°›μ„ μ μλ„λ΅ ν•¨
<br>
<br>

### π‘‰ Dockerμ—μ„ μ†μΌ“ νμΌμ μ—­ν• 

---

- Dockerμ—μ„ μ†μΌ“ νμΌμ€ Docker λ°λ¬(Dockerμ λ°±κ·ΈλΌμ΄λ“ ν”„λ΅μ„Έμ¤λ΅ λ¨λ“  Docker κ΄€λ ¨ μ‘μ—… μ²λ¦¬)κ³Ό ν΄λΌμ΄μ–ΈνΈ(λ…λ Ήμ–΄ λ„κµ¬ λλ” API) κ°„μ ν†µμ‹ μ„ κ°€λ¥ν•κ² ν•΄μ£Όλ” νμΌ
- Docker λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•κ±°λ‚ API νΈμ¶μ„ ν†µν•΄ μ»¨ν…μ΄λ„λ¥Ό κ΄€λ¦¬ν•  λ• μ‚¬μ©
- κΈ°λ³Έμ μΌλ΅ Dockerλ” Unix μ†μΌ“ νμΌμ„ μ‚¬μ©ν•μ—¬ λ°λ¬(dockerd)κ³Ό ν΄λΌμ΄μ–ΈνΈ(docker λ…λ Ήμ–΄ λ“±) κ°„μ ν†µμ‹ μ„ μ²λ¦¬
    - Unix μ†μΌ“ νμΌμ€ λ„¤νΈμ›ν¬ ν”„λ΅ν† μ½ μ—†μ΄ λ΅μ»¬ μ‹μ¤ν…μ—μ„ ν†µμ‹ μ„ κ°€λ¥ν•κ² ν•¨ β†’ λ„¤νΈμ›ν¬λ¥Ό κ±°μΉμ§€ μ•μ•„ μ„±λ¥μ΄ λ” μΆ‹μ
- μ£Όμ” μ—­ν• 
    - μ‚¬μ©μκ°€ μ…λ ¥ν• λ…λ Ήμ–΄λ¥Ό ν΄λΌμ΄μ–ΈνΈμ—μ„ Docker λ°λ¬μΌλ΅ μ „λ‹¬
    - λ°λ¬μ΄ μ „λ‹¬ λ°›μ€ λ…λ Ήμ–΄λ¥Ό μν–‰
    - λ°λ¬μ΄ μν–‰ν• κ²°κ³Όλ¥Ό λ‹¤μ‹ ν΄λΌμ΄μ–ΈνΈλ΅ λ°ν™
- μμ‹
    - νμΌ μ΄λ¦„μ΄ `docker.sock`μ΄λΌλ©΄, μ΄λ” Docker λ°λ¬κ³Ό ν΄λΌμ΄μ–ΈνΈ κ°„μ ν†µμ‹ μ„ λ‹΄λ‹Ήν•λ” μ†μΌ“ νμΌ
    - Docker λ…λ Ήμ–΄ (`docker ps`, `docker run` λ“±)λ¥Ό μ…λ ¥ν•  λ•, μ΄ λ…λ Ήμ–΄λ“¤μ΄ `docker.sock` νμΌμ„ ν†µν•΄ Docker λ°λ¬μ— μ „λ‹¬ β†’ λ°λ¬μ΄ ν•΄λ‹Ή λ…λ Ήμ„ μν–‰ν• λ’¤ κ²°κ³Όλ¥Ό λ‹¤μ‹ ν΄λΌμ΄μ–ΈνΈλ΅ μ „λ‹¬ν•λ” κµ¬μ΅°
    <br>
    <br>

### π‘‰ Docker μ†μΌ“ νμΌ μ‚¬μ© μμ‹

---

- Docker CLI
    
    ```docker
    sudo docker run hello-world
    ```
    
    - Dockerλ” λ‚΄λ¶€μ μΌλ΅ /var/run/docker.sockμ„ ν†µν•΄ λ°λ¬μ— hello-world μ΄λ―Έμ§€λ¥Ό μ‹¤ν–‰ν•λΌλ” μ”μ²­μ„ λ³΄λƒ„
    - λ°λ¬μ΄ μ΄ μ”μ²­μ„ μν–‰ν•κ³  κ²°κ³Όλ¥Ό λ‹¤μ‹ λ°ν™
    <br>
- Docker API(νμ΄μ¬ μ½”λ“)
    
    ```python
    import docker
    client = docker.DockerClient(base_url='unix://var/run/docker.sock')
    container = client.containers.run("hello-world", detach=True)
    print(container.logs())
    ```
    
    - `base_url='unix://var/run/docker.sock'` λ¶€λ¶„μ΄ Docker μ†μΌ“ νμΌμ„ ν†µν•΄ λ°λ¬μ— μ ‘κ·Όν•κ² λ‹¤λ” μλ―Έ
  <br>
  <br>

### π‘‰ Dockerμ—μ„ μ†μΌ“ νμΌ λ§μ΄νΈμ μλ―Έ

---

- Dockerλ¥Ό μ‚¬μ©ν•  λ• μ†μΌ“ νμΌμ„ μ»¨ν…μ΄λ„μ— λ§μ΄νΈν•λ” κ²½μ°κ°€ μμ
- μ΄λ¥Ό ν†µν•΄ μ»¨ν…μ΄λ„ λ‚΄λ¶€μ—μ„ νΈμ¤νΈμ Docker λ°λ¬μ— μ ‘κ·Όν•  μ μκ² λλ”λ°, μ΄λ ‡κ² ν•λ©΄ μ»¨ν…μ΄λ„κ°€ Docker λ°λ¬κ³Ό μ§μ ‘ ν†µμ‹ ν•  μ μκ² λ¨
    - μ»¨ν…μ΄λ„ λ‚΄λ¶€μ—μ„ λ λ‹¤λ¥Έ μ»¨ν…μ΄λ„λ¥Ό μƒμ„±ν•κ±°λ‚ μ‚­μ ν•  μ μλ” κ¶ν•μ΄ μƒκΈ°κ² λλ” κ²ƒ
- μμ‹
    
    ```docker
    docker run -v /var/run/docker.sock:/var/run/docker.sock -it my-container
    ```
    
    - νΈμ¤νΈμ `/var/run/docker.sock` νμΌμ„ μ»¨ν…μ΄λ„ λ‚΄λ¶€μ `/var/run/docker.sock` κ²½λ΅μ— λ§μ΄νΈ
    - μ΄λ ‡κ² ν•λ©΄ my-containerλΌλ” μ»¨ν…μ΄λ„ λ‚΄λ¶€μ—μ„ Docker CLIλ¥Ό ν†µν•΄ νΈμ¤νΈμ Docker λ°λ¬μ— μ ‘κ·Όν•  μ μμ
    <br>
    <br>

### π‘‰ Dockerμ—μ„ μ†μΌ“ νμΌμ΄ μ—†λ‹¤λ©΄?

---

- `/var/run/docker.sock` νμΌμ΄ μ—†κ±°λ‚ μ ‘κ·Όμ΄ λ¶κ°€λ¥ν• κ²½μ°μ—λ” Docker λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•  λ• `Cannot connect to the Docker daemon`μ΄λΌλ” μ¤λ¥ λ°μƒ
<br>
<br>

### π‘‰ Dockerμ—μ„ μ†μΌ“ νμΌμ„ ν†µν• ν†µμ‹  κ³Όμ •

---

1. Docker λ°λ¬(dockerd)μ΄ μ‹¤ν–‰λλ©΄ /var/run/docker.sock νμΌμ΄ μƒμ„±
    - μ†μΌ“ νμΌμ€ Unix μ†μΌ“μ„ ν†µν•΄ ν΄λΌμ΄μ–ΈνΈμ™€ λ°λ¬ κ°„ ν†µμ‹ μ„ λ‹΄λ‹Ήν•λ” μΌμΆ…μ μ—”λ“ν¬μΈνΈ μ—­ν• 
2. μ‚¬μ©μκ°€ docker λ…λ Ήμ–΄λ¥Ό μ…λ ¥ν•λ©΄, Docker ν΄λΌμ΄μ–ΈνΈλ” μ΄ λ…λ Ήμ„ HTTP μ”μ²­μΌλ΅ λ³€ν™ν•μ—¬ μ†μΌ“ νμΌμ„ ν†µν•΄ λ°λ¬μ—κ² μ „λ‹¬
    - Dockerλ” HTTP κΈ°λ° REST APIλ¥Ό μ‚¬μ©ν•μ—¬ λ…λ Ήμ„ μ²λ¦¬ν•λ©°, μ΄ μ”μ²­μ΄ TCP λ€μ‹  λ΅μ»¬ Unix μ†μΌ“ νμΌμ„ ν†µν•΄ μ „λ‹¬
        - HTTP ν†µμ‹  λ°©μ‹μ€ ν΄λΌμ΄μ–ΈνΈκ°€ HTTP μ”μ²­μ„ λ³΄λ‚΄κ³ , μ„λ²„κ°€ HTTP μ‘λ‹µμ„ λ°ν™ν•λ” ν¨ν„΄
        - μ—¬κΈ°μ„ `HTTP κΈ°λ°`μ΄λΌλ” κ²ƒμ€ λ…λ Ήμ–΄κ°€ HTTP ν”„λ΅ν† μ½μ ν•μ‹μ„ λ”°λ¥΄λ” κ²ƒμ„ μλ―Έν•λ©°, μ‹¤μ  λ„¤νΈμ›ν¬λ¥Ό ν†µν• HTTP ν†µμ‹ (TCP/IP)μ„ μ‚¬μ©ν•μ§€ μ•μ
        - Unix μ†μΌ“μ€ λ„¤νΈμ›ν¬ μ—†μ΄ λ΅μ»¬μ—μ„ ν΄λΌμ΄μ–ΈνΈμ™€ λ°λ¬ κ°„μ— λ°μ΄ν„° μ „μ†΅μ„ μ²λ¦¬ν•¨
    - μμ‹
        - `docker ps`λΌλ” λ…λ Ήμ–΄ μ‹¤ν–‰ μ‹, ν΄λΌμ΄μ–ΈνΈκ°€ /containers/jsonμ΄λΌλ” HTTP μ”μ²­μ„ λ³΄λ‚΄λ” κ²ƒμΌλ΅ λ³€ν™
            
            ```docker
            GET /containers/json HTTP/1.1
            Host: /var/run/docker.sock
            ```
            
        - μ΄ μ”μ²­μ€ /var/run/docker.sock νμΌμ„ ν†µν•΄ λ°λ¬μ—κ² μ „λ‹¬
3. Docker λ°λ¬μ€ ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° λ°›μ€ HTTP μ”μ²­μ„ μ²λ¦¬
4. λ°λ¬μ΄ μ”μ²­μ„ μ²λ¦¬ν• ν›„, κ·Έ κ²°κ³Όλ” λ‹¤μ‹ μ†μΌ“ νμΌμ„ ν†µν•΄ ν΄λΌμ΄μ–ΈνΈμ—κ² μ „λ‹¬
    - μλ¥Ό λ“¤μ–΄, `docker ps` λ…λ Ήμ κ²°κ³Όλ΅λ” μ‹¤ν–‰ μ¤‘μΈ μ»¨ν…μ΄λ„ λ©λ΅μ΄ JSON ν•μ‹μΌλ΅ λ°ν™
        
        ```json
        HTTP/1.1 200 OK
        Content-Type: application/json
        
        [
          {
            "Id": "8dfafdbc3a40",
            "Names": ["/cool_name"],
            "Image": "redis",
            "State": "running"
          }
        ]
        ```
        
    - ν΄λΌμ΄μ–ΈνΈλ” μ΄ κ²°κ³Όλ¥Ό λ°›μ•„ μ‚¬μ©μκ°€ λ³΄κΈ° μ‰½κ² μ¶λ ¥
